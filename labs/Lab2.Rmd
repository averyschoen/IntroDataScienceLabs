---
title: "Lab 2"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(dplyr)
library(ggplot2)
library(gradethis)
library(learnr)
library(MASS)
library(readr)

tutorial_options(exercise.checker = gradethis::grade_learnr)

data("starwars")
```

## Goals

Your goal is practice creating histograms, density plots, box plots, and bar plots with `ggplot2`, as well as calculating some basic summary statistics. At the end of the lab, you should also make sure that you can download the RMarkdown homework template and use it to turn in your next homework assignment (Homework 2). 

## Part 1: Loading Packages

### Installation

R has many predefined functions and datasets that you can use--these functions are fairly basic, like `dim()`, `head()`, `mean()`, and `sd()`. Sometimes, we want additional specialized functions or datasets that others have created for us, and these specialized functions and datasets come in *packages*. For example, `ggplot2` is a package designed specifically for creating graphics. 

When you want to use a new R package, you first have to download it. This can be done via code:

```{r, eval = FALSE}
install.packages("ggplot2")
```

You can also install a package by navingating to the "Packages" tab in the window in the lower, righthand corner. 

* Click on the "Install" button, which looks like a box with a downward facing arrow on it. 
* Type the name of the package into the "Packages" bar in the pop-up window. 
* Make sure the "Install dependencies" box is checked! This means that if there are any other necessary packages, they will be installed at the same time--hopefully, you will not have to repeat this process multiple times. 
* Hit the "Install" button. Lots of code will pop up in your console--when it is done running, you can proceed. 

I prefer to install packages this way, because of the ability to automatically install dependencies. There are much fewer opportunities for missing components. 

Take this time to make sure that everyone is able to install the packages `dplyr` and `ggplot2` onto their own machine!

### Loading

Once you have installed a package, you also need to load it. In fact, you only need to install the package once, but every time you open a new document and want to use the package, you will need to load it. 

Packages are loaded with the `library()` command, as below. For this lab, we will use 2 packages that add extra functionality to R: `dplyr` and `ggplot2`. Go ahead and run this code chunk now.

```{r loadpackages, exercise = T}
library(dplyr)
library(ggplot2)
```

Again, packages need to be loaded EVERY time you want to use them! If you are getting errors like "could not find function", it is likely because you forgot to load a package. I usually write the lines of code required to load a package at the top of the R script so they are loaded and ready to use when I need them. 

Take this time to make sure that everyone is able to load `dplyr` and `ggplot2` onto their own machine!

## Part 2: Reading in Data

Previously, we learned how to read files saved on a local machine into R, but remember that there are a couple of other ways to load data. For this class, we will mostly be installing packages that contain practice datasets. Today, we will be using `starwars`, which contains basic demographic information on the characters in the Star Wars universe. `starwars` is located in the `dplyr` package, which we loaded above. To call the dataset into R so you can use it, you can run the following code. 

```{r loaddata, exercise = T}
data("starwars")
```


## Part 3: Data Exploration

Before we begin, we should make sure our dataset is stored in an appropriate format. Any time we use `ggplot2`, we want to be working with a data frame (what R calls a data matrix). Confirm that `starwars` is a data frame using the `is.data.frame()` function. 

```{r dataframes, exercise = TRUE}

```

```{r dataframes-solution, message = FALSE, warning = FALSE, echo = FALSE, eval = FALSE}
is.data.frame(starwars)
```

```{r dataframes-check, message = FALSE, warning = FALSE}
grade_code()
```

<div id="dataframes-hint">
**Hint:** If you don't know how to use the `is.data.frame()` function, use the help menu. You can access the help menu with the `?`. 
</div>

As you have seen, functions in R are similar to mathematical functions. However, not all functions require numbers as inputs, such as the `is.data.frame()` function. Another function that does not require numbers as inputs is `glimpse()`, which displays the first few values for every variable (as well as the format the variable is stored in). 

Use the `glimpse()` function with `starwars` to look at the first six rows of the dataset. It is usually a good idea to look at the dataset, or at least the first few values, so that you know your data look as you expect.  

```{r arguments, exercise = TRUE}

```

```{r arguments-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
glimpse(starwars)
```

```{r arguments-check, message = FALSE, warning = FALSE}
grade_code()
``` 

Some functions in R accept more than one input--these inputs are also known as arguments. `head()`, which displays the first $n$ rows of a dataset, is one of those functions. You can change the number of rows displayed by changing the `n` argument. For instance, you can display the first 4 rows of the `starwars` data frame using `head(starwars, n = 4)`.

Change the following line of code to display the first 10 rows of the `starwars` data frame. 

```{r arguments2, exercise = TRUE}
head(starwars, n = 4)

```

```{r arguments2-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
head(starwars, n = 10)
```

```{r arguments2-check, message = FALSE, warning = FALSE}
grade_code()
``` 

It is also of interest to know how many rows and columns we are working with. Using the `dim()` function, find the number of rows in the `starwars` data frame. 

```{r functions, exercise = TRUE}

```

```{r functions-solution, message = FALSE, warning = FALSE, echo = FALSE, eval = FALSE}
dim(starwars)
```

```{r functions-check, message = FALSE, warning = FALSE}
grade_code()
```

```{r 2_1, echo=FALSE, eval = F}
question("How many rows does the `starwars` dataframe contain?",
  answer("87", correct = TRUE),
  answer("1"),
  answer("14", message = "That's the number of variables!"),
  allow_retry = T,
  random_answer_order = TRUE
)
```

Finally, we might also be interested in knowing exactly which variables are contained in the dataset. In a dataframe, the variables are usually stored in the column names (you may have also seen them in the output of your `glimpse()` and `head()` functions). We can access the names using `colnames`. 

```{r functions2, exercise = TRUE}

```

```{r functions2-solution, message = FALSE, warning = FALSE, echo = FALSE, eval = FALSE}
colnames(starwars)
```

```{r functions2-check, message = FALSE, warning = FALSE}
grade_code()
```

```{r 2_2, echo=FALSE}
question("Which of the following is not a valid variable name from `starwars`?",
  answer("`age`", correct = TRUE),
  answer("`name`"),
  answer("`height`"),
  answer("`vehicles`"),
  allow_retry = T,
  random_answer_order = TRUE
)
```

If you are confused about the variables, you can use the help menu to read more about them. To use the help menu, you type a question mark (`?`) in front of the data frame or function for which you want more information. 

Access the help menu for the `starwars` data frame. Note that it looks very messy in this tutorial, but it should look better in your actual RStudio window.

```{r help, exercise = TRUE}

```

```{r help-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
?starwars
```

```{r help-check, message = FALSE, warning = FALSE}
grade_code()
```

```{r 2_10, echo=FALSE}
question("What does the acronym BBY mean, as used in the variable `birth_year`?",
  answer("Before Battle of Yavin", correct = TRUE),
  answer("Baby"),
  answer("Best Buy"),
  answer("Bed Bath and Beyond"),
  allow_retry = T,
  random_answer_order = TRUE
)
```

```{r 2_11, echo=FALSE}
question("What tpye of variable is `species`?",
  answer("Discrete"),
  answer("Continuous"),
  answer("Nominal", correct = TRUE),
  answer("Ordinal"),
  allow_retry = T,
  random_answer_order = TRUE
)
```

```{r 2_12, echo=FALSE}
question("What tpye of variable is `mass`?",
  answer("Numerical", correct = TRUE),
  answer("Categorical"),
  allow_retry = T,
  random_answer_order = TRUE
)
```

```{r 2_13, echo=FALSE}
question("Which of the following are categorical (select all that apply)? ",
  answer("name", correct = TRUE),
  answer("eye_color", correct = TRUE),
  answer("sex", correct = TRUE),
  answer("gender", correct = TRUE),
  answer("height"),
  answer("birth_year"),
  allow_retry = T,
  random_answer_order = TRUE
)
```

## Part 4: `ggplot2`

Now, we can finally start using `ggplot2` to create graphs! `ggplot2` is a "system for declaratively creating graphics", based on the book, *The Grammar of Graphics*. 

You, as the user, tell `ggplot2` what data to use, how to map the variables to the different aesthetics of the graph, and what type of graph you need--`ggplot2` takes care of the rest!  

First, we start by providing the data and mapping the variables to the graph's aesthetics. This means that we are defining things like what's on the $x$-axis or what color the graph is, among many others. 

A sample line of code for investigating the heights of different characters appears inside the box below. 

```{r ggplot1, exercise = TRUE}
ggplot(data = starwars, aes(x = height))
```

If you run this chunk, a big, nearly blank box appears--there is no actual graph, but we can see that the `height` variable is now located on the $x$-axis. There's nothing there because we haven't added a **geom** yet. A geom is a command representing the type of plot we want. 

### Histograms

To add a histogram, we use `+ geom_histogram()`. 

```{r ggplot2, exercise = TRUE}
ggplot(data = starwars, aes(x = height)) + 
  geom_histogram()
```

```{r ggplot25, echo=FALSE}
question("Describe the distribution of `height` (select all that apply). ",
  answer("Right-Skewed"),
  answer("Left-Skewed", correct = TRUE),
  answer("Symmetric"),
  answer("Uniform"),
  answer("Unimodal"),
  answer("Bimodal", correct = TRUE),
  answer("Multimodal"),
  allow_retry = T
)
```

Do you see a warning message saying "`stat_bin() using bins = 30. Pick better value with binwidth`"? This error is unique to `geom_histogram()`. To fix the warning, we can change the number of bins by adding a new argument, `bins = 10`, into the "`geom_histogram()`" function. 

```{r ggplot3, exercise = TRUE}
ggplot(data = starwars, aes(x = height)) +
  geom_histogram()
```

```{r ggplot3-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
ggplot(data = starwars, aes(x = height)) +
  geom_histogram(bins = 10)
```

```{r ggplot3-check, message = FALSE, warning = FALSE}
grade_code()
```

What happens to the histogram? Would you describe it in the same way as you described your first histogram? Are there any differences?

You can also avoid the message by specifying the `binwidth` instead of `bins`. There is a direct relationship between the bin width and the number of bins, so setting one also fixes the other. In general, increasing the number of bins leads to narrower wins, and decreasing the number of bins leads to wider bins,

Instead of creating a histogram with 10 bins, create a histogram where the bin width is 20. 

```{r ggplot4, exercise = TRUE}
ggplot(data = starwars, aes(x = height)) +
  geom_histogram(bins = 10)
```

```{r ggplot4-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
ggplot(data = starwars, aes(x = height)) +
  geom_histogram(binwidth = 20)
```

```{r ggplot4-check, message = FALSE, warning = FALSE}
grade_code()
```

Notice that on the $y$-axis, we are displaying the counts of the observations in each bin. We can change this to instead display the frequency by adding another argument to `geom_histogram()`.

```{r ggplot5, exercise = TRUE}
ggplot(data = starwars, aes(x = height)) +
  geom_histogram(bins = 10, aes(y=..density..))
```

See how the scale has changed? By using `y=..density..`, we can directly compare a histogram and a density plot!

```{r ggplot55, exercise = TRUE}
ggplot(data = starwars, aes(x = height)) +
  geom_histogram(bins = 10, aes(y=..density..)) +
  geom_density()
```

We can see two things from this latest graph--

1. There is a relationship between a histogram and a density plot! When created from the same dataset, they should show roughly the same shape. 
2. You can add multiple geoms to a graph! In fact, this is how we build the graphs--by supplying the dataset and variable mapping in the first `ggplot()` command, then by adding different things using different geoms. In this case, we added both a histogram (`geom_histogram()`) and a density (`geom_density()`). 

Now, try creating your own combination histogram/density plot for the variable `mass`. What do you see?

```{r ggplot6, exercise = TRUE}

```

```{r ggplot6-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
ggplot(data = starwars, aes(x = mass)) +
  geom_histogram(bins = 10, aes(y=..density..)) +
  geom_density()
```

```{r ggplot6-check, message = FALSE, warning = FALSE}
grade_code()
```

```{r ggplot35, echo=FALSE}
question("Describe the distribution of `mass` (select all that apply). ",
  answer("Right-Skewed", correct = TRUE),
  answer("Left-Skewed"),
  answer("Symmetric"),
  answer("Uniform"),
  answer("Unimodal", correct = TRUE),
  answer("Bimodal"),
  answer("Multimodal"),
  allow_retry = T
)
```

### Boxplots 

Now, we can try creating a box plot. This time, try using the [ggplot2 cheat sheet](https://rstudio.com/wp-content/uploads/2015/03/ggplot2-cheatsheet.pdf) to look up the appropriate geom you need (the cheat sheet is also posted in the R Resources folder on Moodle). The first page of the cheat sheet shows a list of all the possible geoms you can have.

```{r ggplot7, exercise = TRUE}
ggplot(data = starwars, aes(x = height)) + 
```

```{r ggplot7-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
ggplot(data = starwars, aes(x = height)) +
  geom_boxplot()
```

```{r ggplot7-check, message = FALSE, warning = FALSE}
grade_code()
```

Remember that we use boxplots to look at the distributions over different levels of a categorical variable. To create a plot with a boxplot for every level, you can add a `y = ` argument to the aesthetics function. Try creating a boxplot for every level of `sex`.

```{r ggplot8, exercise = TRUE}
ggplot(data = starwars, aes(x = height)) + 
    geom_boxplot()
```

```{r ggplot8-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
ggplot(data = starwars, aes(x = height, y = sex)) +
  geom_boxplot()
```

```{r ggplot8-check, message = FALSE, warning = FALSE}
grade_code()
```

<!-- Does this look like you expect? In R, categorical variables should be stored as "factors"--otherwise, they won't behave the way we expect. Use the factor `is.factor()` to check if the variable `chas` (whether the suburb borders the Charles River) is a factor.  -->

<!-- ```{r factor, exercise = TRUE} -->

<!-- ``` -->

<!-- ```{r factor-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE} -->
<!-- is.factor(Boston$chas) -->
<!-- ``` -->

<!-- ```{r factor-check, message = FALSE, warning = FALSE} -->
<!-- grade_code() -->
<!-- ``` -->

<!-- As it is stored right now, `chas` is not a factor. To fix that, we can turn it into a factor using the `as.factor()` function.  -->

<!-- ```{r ggplot9, exercise = TRUE} -->
<!-- ggplot(data = Boston, aes(x = medv, y = chas))) +  -->
<!--   geom_boxplot() -->
<!-- ``` -->

<!-- ```{r ggplot9-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE} -->
<!-- ggplot(data = Boston, aes(x = medv, y = as.factor(chas))) + -->
<!--   geom_boxplot() -->
<!-- ``` -->

<!-- ```{r ggplot9-check, message = FALSE, warning = FALSE} -->
<!-- grade_code() -->
<!-- ``` -->

<!-- This looks more like it! However, it is hard to tell which boxplot corresponds to which level. We will learn more about this later, but for now, know that 0 corresponds to the houses that do not border the Charles River and a 1 corresponds to the houses that do. What can you say about the median value of the houses in suburbs that border the river versus those that don't? -->

### Colors

Now adding a `color = "red"` argument to the `geom_boxplot()` statement. 

```{r ggplot10, exercise = TRUE}
ggplot(data = starwars, aes(x = height, y = sex)) + 
    geom_boxplot()
```

```{r ggplot10-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
ggplot(data = starwars, aes(x = height, y = sex)) +
  geom_boxplot(color = "red")
```

```{r ggplot10-check, message = FALSE, warning = FALSE}
grade_code()
```

This looks kind of messy, but you should have managed to change the color! Now try changing the color to something different. You can use this [R color guide](http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf) to look up the available colors on Moodle. 

```{r ggplot11, exercise = TRUE}
ggplot(data = starwars, aes(x = height, y = sex)) +
  geom_boxplot(color = "red")
```

On your assignments, you can pick whatever color you want! But in addition, you can change the color according to the categorical variable, so that each level is its own color. To do this, you can change the `color` argument to be the name of a variable (in this case, `sex`) inside the `aes()` statement (rather than `geom_boxplot()`).

Based on the following chunk, make each level of `sex` its own color.

```{r ggplot12, exercise = TRUE, message = FALSE}
ggplot(data = starwars, aes(x = height, y = sex)) + 
   geom_boxplot(color = "red")
```

```{r ggplot12-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
ggplot(data = starwars, aes(x = height, y = sex, color = sex)) + 
   geom_boxplot()
```

```{r ggplot12-check, message = FALSE, warning = FALSE}
grade_code()
```

Adding a color according to a variable works differently depending on if the variable is numeric or categorical. If your variable is categorical, it needs to be saved as a "factor" or as a "character string"--you can check this by looking at the `glimpse()` output. 

```{r ggplot13, exercise = TRUE, message = FALSE}
glimpse()
```

```{r ggplot13-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
glimpse(starwars)
```

```{r ggplot13-check, message = FALSE, warning = FALSE}
grade_code()
```

If you look back at the `glimpse()` output, you may see some light gray type saying `<chr>`. What this is telling you is that `sex` is saved as a character string, or a list of letters inside quotation marks. When R sees that a variable is saved as a character string or as a factor, it automatically imposes a scale where the colors for each level are equally spaced on a color line.

#### Logical Operators

You can also see that `sex` has at least three values in it--`"male"`, `"none"`, `"female"`.  This is not a complete picture of the variable. Try using `unique()` to see what happens. 

```{r ggplot14, exercise = TRUE, message = FALSE}
unique()
```

```{r ggplot14-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
unique(starwars$sex)
```

```{r ggplot14-check, message = FALSE, warning = FALSE}
grade_code()
```

<div id="ggplot14-hint">
**Hint:** You need to specifically check what's inside the column `sex` inside the dataframe `starwars`, which means you need to use the dollar sign operator. The dollar sign operator allows you to pull out a specific column from a dataframe.
</div>

Now you can see that the values in `starwars$sex` are `"male"`, `"none"`, `"female"`, `"hermaphroditic"`, and `NA`. `"male"` and `"female"` refer to the standard definitions of sex,  `"none"` refers to droids like R2-D2 and C-3PO who are manufactured and cannot reproduce, and `"hermaphroditic"` refers to one specific character, Jabba the Hutt (members of the Hutt species have multiple sex organs and and need no partners to produce children, see [Wookieepedia](https://starwars.fandom.com/wiki/Hutt/Legends) for more details). The last value, `NA`, doesn't refer to a level of this variable at all, but instead indicates a missing value in the dataframe. 

To find out more about the missing values, we can use the `filter()` function. Run the code chunk below. 

```{r ggplot15, exercise = TRUE, message = FALSE}
starwars %>%
  filter(is.na(sex) == TRUE)
```

Let's break down this code:

* First, we specify that we would like to be looking in the `starwars` dataframe.
* Second, we link our two statements, `starwars` and `filter()`, with the pipe operator, `%>%`. 
* The filter function itself "filters" the data, and prints out only values that satisfy a certain condition. In this case, the condition is that the value for `sex` is missing (you can confirm this in the output). 

How do I write the conditions? I can use a special type of operator in R called a **logical operator**. A logical operator is a symbol that links two statements and results in a true or false statement. You may be familiar with these operators from your previous math classes--consider greater than (`>`) or less than (`>`). 

Write a line of code to confirm that seven is greater than five. 

```{r greaterthan, exercise = TRUE}

```

```{r greaterthan-solution, message = FALSE, warning = FALSE, echo = FALSE, eval = FALSE}
7 > 5
```

```{r greaterthan-check, message = FALSE, warning = FALSE}
grade_code()
```

```{r 4_1, echo=FALSE}
question("What is the output?",
  answer("TRUE", correct = TRUE),
  answer("FALSE"),
  answer("0"),
  answer("1"),
  allow_retry = T,
  random_answer_order = TRUE
)
```

Notice that the logical operator results in `TRUE`--now write a line of code to confirm that eight is NOT greater than eleven. 

```{r lessthan, exercise = TRUE}

```

```{r lessthan-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
8 > 11
```

```{r lessthan-check, message = FALSE, warning = FALSE}
grade_code()
```

```{r 4_2, echo=FALSE}
question("What is the output?",
  answer("TRUE"),
  answer("FALSE", correct = TRUE),
  answer("0"),
  answer("1"),
  allow_retry = T,
  random_answer_order = TRUE
)
```

Here, you can see the statement is `FALSE`. Other logical operators include equal to `==` (notice that R requires two equals signs, not just 1)! Write a line of code to confirm that the square root of sixteen is 4. Be careful to use TWO equal signs. 

```{r equalto, exercise = TRUE}

```

```{r equalto-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
sqrt(16) == 4
```

```{r equalto-check, message = FALSE, warning = FALSE}
grade_code()
```

Finally, we may be interested in values that are not equal to other values. To test if values are not equal, use `!=`. Write a line of code to confirm that the square root of 81 is not equal to 6. 

```{r notequalto, exercise = TRUE}

```

```{r notequalto-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
sqrt(81) != 6
```

```{r notequalto-check, message = FALSE, warning = FALSE}
grade_code()
```
 
You can find out more about other logical operators [here](https://www.statmethods.net/management/operators.html). Notice in our filter statement, we checked `is.na(sex) == TRUE`--`is.na()` is a special function that will evaluate each value to see if it is missing. If the value is missing, `is.na()` returns a `TRUE`, so we pulled all the values of `sex` that are missing by finding the values that are equal to `TRUE`. You can see that four characters (Ric Olié, Quarsh Panaka, Sly Moore, and Captain Phasma) all have missing values for `sex`. 

#### (Some) Data Cleaning

For now, we may want to ignore the missing values. Again, we can use the `filter()` statement. 

```{r ggplot16, exercise = TRUE, message = FALSE}
starwars_complete <- starwars %>%
  filter(is.na(sex) != TRUE)
```

The first few lines of code save `starwars_complete` as a filtered version of `starwars` with only non-missing values. Now, you can recreate the graph without having to deal with the missing values in the chunk below.

```{r prepare-complete}
starwars_complete <- starwars %>%
  filter(is.na(sex) != TRUE)
```

```{r ggplot17, exercise = TRUE, message = FALSE, exercise.setup = "prepare-complete"}

```

```{r ggplot17-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
ggplot(data = starwars_complete, aes(x = height, y = sex, color = sex)) + 
   geom_boxplot()
```

```{r ggplot17-check, message = FALSE, warning = FALSE}
grade_code()
```

It is fine with me if you use the default color scheme in `ggplot2`, but if you want more color options, you can use the `RColorBrewer` package (or, the `wesanderson` package, which creates color palettes based on Wes Anderson movies--I like "GrandBudapest2").

To change the palette, load the `RColorBrewer` library and add a line of code to your graph. Notice that I am using `scale_color_brewer()` because I am changing the `color` inside `aes()`. What happens if you specify `palette="PiYG"` inside the new function?

```{r ggplot18, exercise = TRUE, message = FALSE, exercise.setup = "prepare-complete"}
library(RColorBrewer)
ggplot(data = starwars_complete, aes(x = height, y = sex, color = sex)) + 
   geom_boxplot() +
   scale_color_brewer()
```

```{r ggplot18-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
library(RColorBrewer)
ggplot(data = starwars_complete, aes(x = height, y = sex, color = sex)) + 
   geom_boxplot() +
   scale_color_brewer(palette="PiYG")
```

```{r ggplot18-check, message = FALSE, warning = FALSE}
grade_code()
```

You can explore more color palette options (and the `wesanderson` package) [here](http://www.sthda.com/english/wiki/ggplot2-colors-how-to-change-colors-automatically-and-manually).

### Bar Charts

So far you know `geom_histogram()`, `geom_density()`, and `geom_boxplot()` for making histograms, densities, and boxplots. The last type of graph we discussed in class is a bar chart/plot--the geom you use to make a bar chart/plot is `geom_bar()`.

Let's focus on the variable `species` in the original dataset `starwars`. Using what you know about `ggplot2`, create a bar chart of `species` where each bar is a different color. 

```{r ggplot19, exercise = TRUE, message = FALSE}

```

```{r ggplot19-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
ggplot(data = starwars, aes(x = species, color = species)) + 
  geom_bar() 
```

```{r ggplot19-check, message = FALSE, warning = FALSE}
grade_code()
```

You might notice that the bars are only outlined in color. If you want the whole bar to be the same color, use the argument `fill` instead. 

```{r ggplot20, exercise = TRUE, message = FALSE}
ggplot(data = starwars, aes(x = species, color = species)) + 
  geom_bar() 
```

```{r ggplot20-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
ggplot(data = starwars, aes(x = species, fill = species)) + 
  geom_bar() 
```

```{r ggplot20-check, message = FALSE, warning = FALSE}
grade_code()
```

There is one dominant species, but it's really hard to tell exactly what it is from the axis labels! Run the following chunk of code-the last line rotates the labels for easier readability.

```{r ggplot21, exercise = TRUE, message = FALSE}
ggplot(data = starwars, aes(x = species, fill = species)) + 
  geom_bar() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
```

Much better!

```{r ggplot22, echo=FALSE}
question("What is the most dominant species in the Star Wars universe?",
  answer("Human", correct = TRUE),
  answer("Droid"),
  answer("Yoda's species"),
  answer("Ewok"),
  answer("Wookiee"),
  allow_retry = T,
  random_answer_order = TRUE
)
```

```{r ggplot23, echo=FALSE}
question("What is the second most dominant species in the Star Wars universe?",
  answer("Human"),
  answer("Droid", correct = TRUE),
  answer("Yoda's species"),
  answer("Ewok"),
  answer("Wookiee"),
  allow_retry = T,
  random_answer_order = TRUE
)
```

`ggplot2` has many other options that we haven’t explored today. If you have time left over, try the following:

* Type `?geom_boxplot` or `geom_histogram()` into your console and review the help menu. What other options can you change? 
* Experiment with some of the other arguments, like `fill` and `size` and note how they change your boxplots.
* See if you can add lines to the graph indicating the mean and median--use the cheat sheet to try and figure out what geom to use.

## Part 5: Summarizing Variables

We can use functions like `mean()`, `median()`, and `sd()`, among others, to summarize different variables. However, we first need to be able to extract the columns from the dataframe.  

In base R, the dollar sign operation (`$`) allows us to extract columns by name from a data frame in R (you saw this before). For instance, `starwars$eye_color` returns the column `eye_color`, which describes the color of each character's eyes. 

Change the following line of code to extract the column named `hair_color`, which describes each character's hair color. 

```{r cextract, exercise = TRUE}
starwars$eye_color
```

```{r cextract-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
starwars$hair_color
```

```{r cextract-check, message = FALSE, warning = FALSE}
grade_code()
```

You can apply `mean()`, `median()`, etc. directly to each column, but I think that the dollar sign syntax is confusing AND I want you all to develop `tidyverse` skills, so we will review how to use the pipe operator instead. 

Every time you summarize a variable, you first start by providing the name of the dataframe you are interested in using:

```{r sumstats1, eval = FALSE, echo = TRUE}
starwars
```

Then, you add a pipe operator, `%>%`. This lets R know that you are about to tell it what calculations to apply to your dataframe. 

```{r sumstats2, eval = FALSE, echo = TRUE}
starwars %>%
```

Then, hit return (for the sake of readability, hit return after every pipe). Now, we tell R what we are going to do in general, which is `summarize()`.

```{r sumstats3, eval = FALSE, echo = TRUE}
starwars %>%
  summarize()
```

Inside `summarize()`, we have to specify what exactly we want to do. Let's say you want to summarize the `height` variable using the mean--you would put `mean(height)` INSIDE `summarize()`.

```{r sumstats4,  exercise = TRUE, message = FALSE, exercise.setup = "prepare-complete2"}
starwars %>%
  summarize(mean(height))
```

That doesn't look right! As it turns out, commands like `mean()`, `sd()` etc. don't like missing values--any time there is an `NA` in the dataset, the commands will also return `NA`. We can add an extra argument, `na.rm = FALSE`, to tell R to ignore the missing values.

```{r sumstats5, exercise = TRUE, message = FALSE, exercise.setup = "prepare-complete2"}
starwars %>%
  summarize(mean(height, na.rm = TRUE))
```

Perfect!

As we did in class, you can add additional commands inside `summarize()`. Add code to the chunk below so that you get the mean and standard deviation out. 

```{r sumstats6, exercise = TRUE, message = FALSE, exercise.setup = "prepare-complete2"}
starwars %>%
  summarize(mean(height, na.rm = TRUE))
```

```{r sumstats6-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
starwars %>%
  summarize(mean(height, na.rm = TRUE), sd(height, na.rm = TRUE))
```

```{r sumstats6-check, message = FALSE, warning = FALSE}
grade_code()
```

Great! Now remove the code calculating the standard deviation, and change it so that you get the five-number summary. Relabel each quantity with proper names for less confusion.

```{r sumstats7, exercise = TRUE, message = FALSE, exercise.setup = "prepare-complete2"}
starwars %>%
  summarize(mean(height, na.rm = TRUE), sd(height, na.rm = TRUE))
```

```{r sumstats7-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
starwars %>%
  summarize(Minimum = min(height, na.rm = TRUE), 
            Q1 = quantile(height, 0.25, na.rm = TRUE), 
            Median = median(height, na.rm = TRUE), 
            Q3 = quantile(height, 0.75, na.rm = TRUE), 
            Maximum = max(height, na.rm = TRUE))
```

```{r sumstats7-check, message = FALSE, warning = FALSE}
grade_code()
```

```{r 2_8, echo=FALSE, eval = F}
question("What is the third quartile of the `height` variable?",
  answer("66", message = "That's the minimum!"),
  answer("167", message = "That's the first quartile!"),
  answer("180", message = "That's the median!"),
  answer("191", correct = TRUE),
  answer("264", message = "That's the maximum!"),
  allow_retry = T,
  random_answer_order = TRUE
)
```

Think back to your histograms and boxplots. Based on this dataset, is it better to use the mean and standard deviation, or the five number summary to describe this variable? Why?







