---
title: "Lab 11"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(dplyr)
library(ggplot2)
library(gradethis)
library(learnr)
library(MASS)
library(readr)

tutorial_options(exercise.checker = gradethis::grade_learnr)

data("starwars")
```

## Goals

Your goal is practice creating histograms, density plots, box plots, and bar plots with `ggplot2`, as well as calculating some basic summary statistics. At the end of the lab, you should also make sure that you can download the RMarkdown homework template and use it to turn in your next homework assignment (Homework 2). 

## Part 1: Loading Packages

For this lab, we will continue to use 2 packages that add extra functionality to R: `dplyr` and `ggplot2`. Go ahead and run this code chunk now.

```{r loadpackages, exercise = T}
library(dplyr)
library(ggplot2)
```

## Part 2: Reading in Data

Today, we will be using `starwars`, which contains basic demographic information on the characters in the Star Wars universe. `starwars` is located in the `dplyr` package, which we loaded above. We will also be using a dataset called `gestation`, which contains information on pregnancies. To call the datasets into R, you can run the following code.

```{r loaddata, exercise = T}
data("starwars")
gestation <- read.csv("https://dasl.datadescription.com/download/data/3359")
```

## Part 3: Test Review

Similar to Test 1, there will be a section of "Always, Sometimes, Never" questions on the upcoming test. Remember, these are similar to True/False questions, but there are three options rather than two. 

You will be given a statement, which is always, sometimes, or never true. Your job is to select the correct option, depending on the truth of the statement. Tips for answering questions:

* First, consider whether the statement is generally true (Always) or false (Never). You can do this by testing the statement and eliminating one option. Once you choose a general direction, try to find an example *and* a counter example.
* When finding examples and counter examples, make sure to consider any unusual cases! If you are able to find both an example that makes the statement true and an example that makes the statement false, choose "Sometimes". 
* You can also try and clarify *exactly* when the statement is always or never true by crossing out or changing words. This strategy may help you make your decision.

Practice these other Always, Sometimes, Never questions with your group. Talk about how you arrived at each answer. 

```{r ASN1, echo=FALSE}
question("A value that is unlikely to occur in the normal distribution is even less likely in a $t$-distribution.",
  answer("Always", message = "The tails of the $t$-distribution are ALWAYS thicker, therefore, the event is relatively more likely."),
  answer("Sometimes", message = "The tails of the $t$-distribution are ALWAYS thicker, therefore, the event is relatively more likely."),
  answer("Never", correct = TRUE),
  allow_retry = T
)
```

```{r ASN2, echo=FALSE}
question("A test rejected at a 10% significance level would be rejected at a 1% significance level.",
  answer("Always", message = "Consider a p-value of 0.03!"),
  answer("Sometimes", correct = TRUE),
  answer("Never", message = "Consider a p-value of 0.006!"),
  allow_retry = T
)
```

```{r ASN3, echo=FALSE}
question("A p-value is the probability of a test-statistic as extreme or more extreme than the one observed, given that the null hypothesis is true.",
  answer("Always", correct = TRUE),
  answer("Sometimes", message = "Always, by definition!"),
  answer("Never", message = "Always, by definition!"),
  allow_retry = T
)
```

```{r ASN4, echo=FALSE}
question("If a p-value is greater than α = 0.01, we accept the null hypothesis.",
  answer("Always", message = "We do not accept the null hypothesis. You should only ever fail to reject the null hypothesis."),
  answer("Sometimes", message = "We do not accept the null hypothesis. You should only ever fail to reject the null hypothesis."),
  answer("Never", correct = TRUE),
  allow_retry = T
)
```

```{r ASN5, echo=FALSE}
question("In the U.S. court system, a Type II error would be failing to imprison a guilty person.",
  answer("Always", correct = TRUE),
  answer("Sometimes", message = "Always–Type II, avoid the new! The null hypothesis is that the person is innocent. If they are guilty, the alternative is true, and they have failed to reject the null. Therefore, this is a Type II error."),
  answer("Never", message = "Always–Type II, avoid the new! The null hypothesis is that the person is innocent. If they are guilty, the alternative is true, and they have failed to reject the null. Therefore, this is a Type II error."),
  allow_retry = T
)
```

```{r ASN6, echo=FALSE}
question("A test rejected at a 1% significance level would be rejected at a 10% significance level.",
  answer("Always", correct = TRUE),
  answer("Sometimes", message = "Any p-value that is less than 0.01 is also less than 0.10."),
  answer("Never", message = "Any p-value that is less than 0.01 is also less than 0.10."),
  allow_retry = T
)
```

```{r ASN7, echo=FALSE}
question("The significance level is the chance that the alternative hypothesis is true.",
  answer("Always", message = "The significance level is the chance of a Type I error."),
  answer("Sometimes", message = "The significance level is the chance of a Type I error."),
  answer("Never", correct = TRUE),
  allow_retry = T
)
```

```{r ASN8, echo=FALSE}
question("A $t$-test could be used for a dataset with $n < 30$.",
  answer("Always", message = "What about a dataset that is severely non-normal?"),
  answer("Sometimes", correct = TRUE),
  answer("Never"),
  allow_retry = T
)
```

```{r ASN9, echo=FALSE}
question("You have made a Type II error if you fail to reject the null hypothesis.",
  answer("Always", message = "What if the null hypothesis is true?"),
  answer("Sometimes", correct = TRUE),
  answer("Never", message = "What if the null hypothesis is false?"),
  allow_retry = T
)
```

```{r ASN10, echo=FALSE}
question(" I construct a 95% confidence interval for a mean difference that does not contain 0. A two-sided hypothesis test on the same data is rejected at a 5% significance level.",
  answer("Always", correct = TRUE),
  answer("Sometimes", message = "0 is not included in the interval, so it is not a reasonable value for the true mean difference."),
  answer("Never", message = "0 is not included in the interval, so it is not a reasonable value for the true mean difference."),
  allow_retry = T
)
```


## Part 4: Reviewing Data Exploration

Before we begin, I want to remind you that one of the most important parts of statistical analysis is looking at your data! Let's review some basic data exploration with `dplyr` and `ggplot2`. 

### Looking at the Data

Use the `glimpse()` function with `starwars` to look at the dataset. It is usually a good idea to look at the dataset, or at least the first few values, so that you know your data look as you expect.  

```{r arguments, exercise = TRUE}

```

```{r arguments-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
glimpse(starwars)
```

```{r arguments-check, message = FALSE, warning = FALSE}
grade_code()
``` 

It is also of interest to know how many rows and columns we are working with. Using the `dim()` function, find the number of rows in the `starwars` data frame. 

```{r functions, exercise = TRUE}

```

```{r functions-solution, message = FALSE, warning = FALSE, echo = FALSE, eval = FALSE}
dim(starwars)
```

```{r functions-check, message = FALSE, warning = FALSE}
grade_code()
```

```{r 2_1, echo=FALSE, eval = F}
question("How many rows does the `starwars` dataframe contain?",
  answer("87", correct = TRUE),
  answer("1"),
  answer("14", message = "That's the number of variables!"),
  allow_retry = T,
  random_answer_order = TRUE
)
```

Finally, we might also be interested in knowing exactly which variables are contained in the dataset. In a dataframe, the variables are usually stored in the column names (you may have also seen them in the output of your `glimpse()` and `head()` functions). We can access the names using `colnames`. 

```{r functions2, exercise = TRUE}

```

```{r functions2-solution, message = FALSE, warning = FALSE, echo = FALSE, eval = FALSE}
colnames(starwars)
```

```{r functions2-check, message = FALSE, warning = FALSE}
grade_code()
```

```{r 2_2, echo=FALSE}
question("Which of the following is not a valid variable name from `starwars`?",
  answer("`age`", correct = TRUE),
  answer("`name`"),
  answer("`height`"),
  answer("`vehicles`"),
  allow_retry = T,
  random_answer_order = TRUE
)
```

If you are confused about the variables, you can use the help menu to read more about them. To use the help menu, you type a question mark (`?`) in front of the data frame or function for which you want more information. 


### Summary Statistics

We can use functions like `mean()`, `median()`, and `sd()`, among others, to summarize different variables. Let's also review how to use the pipe operator. 

Every time you summarize a variable, you first start by providing the name of the dataframe you are interested in using:

```{r sumstats1, exercise = TRUE}
starwars
```

Then, you add a pipe operator, `%>%`. This lets R know that you are about to tell it what calculations to apply to your dataframe. 

```{r sumstats2, exercise = TRUE}
starwars %>%
```

Then, hit return (for the sake of readability, hit return after every pipe). Now, we tell R what we are going to do in general, which is `summarize()`.

```{r sumstats3, exercise = TRUE}
starwars %>%
  summarize()
```

Inside `summarize()`, we have to specify what exactly we want to do. Let's say you want to summarize the `height` variable using the mean--you would put `mean(height)` INSIDE `summarize()`.

```{r sumstats4,  exercise = TRUE, message = FALSE}
starwars %>%
  summarize(mean(height))
```

That doesn't look right! As it turns out, commands like `mean()`, `sd()` etc. don't like missing values--any time there is an `NA` in the dataset, the commands will also return `NA`. There happen to be missing values in this dataset--to address them, we can add an extra argument, `na.rm = FALSE`, to tell R to ignore the missing values.

```{r sumstats5, exercise = TRUE, message = FALSE}
starwars %>%
  summarize(mean(height, na.rm = TRUE))
```

Now, it isn't immediately obvious why we wrote our code like this--it seems like we're going out of our way to do something that could be done with a simple application of `mean()`, `sd()`, etc. But what we really want is two sets of summary statistics for each group, and you're about to see why it's so much easier!

With base R, you'd have to create new subsets of data--one for each group of interest. We're going to consider the groups defined by `gender` (which describes the gender of various Star Wars characters). Here's how we'd go about this...

```{r sumstats6, exercise = TRUE}
masculine <- subset(starwars, starwars$gender == "masculine")
feminine <- subset(starwars, starwars$gender == "feminine")
none <- subset(starwars, is.na(starwars$gender) == T)

dim(masculine)
mean(masculine$height, na.rm = TRUE)
sd(masculine$height, na.rm = TRUE)

dim(feminine)
mean(feminine$height, na.rm = TRUE)
sd(feminine$height, na.rm = TRUE)

dim(none)
mean(none$height, na.rm = TRUE)
sd(none$height, na.rm = TRUE)
```

This is a lot of code. And it's a pain to have to assign names to two new objects, and apply each function to the new objects... There is a much better way! Simply add another pipe operator and a statement telling R to group different groups together before you summarize them with statistics.

```{r sumstats7, exercise = TRUE, message = FALSE}
starwars %>%
   group_by(gender) %>%
   summarize(Mean = mean(height, na.rm = TRUE))
```

We can also calculate multiple summary statistics at once:

```{r sumstats8, exercise = TRUE, message = FALSE}
starwars %>%
   group_by(gender) %>%
   summarize(Mean = mean(height, na.rm = TRUE), SD = sd(height, na.rm = TRUE), n = n())
```

Note that the function `n()` gives you the number of observations. Not only is this a whole lot easier than creating multiple subsets, but it still creates output that comes in handy for making nice tables (we may see that in a few weeks). You can use code like this to calculate summary statistics for the Prepare step in your hypothesis tests.

Note that we have an extra argument, `na.rm = TRUE`, and a group with only 4 observations (characters with no gender listed). Let's clean up this dataset by removing rows with missing values so it's a bit easier to use... we can do so with the `filter()` function.  

```{r sumstats9, exercise = TRUE, message = FALSE}
starwars <- starwars %>%
  filter(is.na(gender) == FALSE) %>%
  filter(is.na(height) == FALSE)
```

You do not have to know how to use this function in the future--if we need to remove missing values, I will write that code for you, but it is helpful to see how it's done!

### Histograms

```{r prepare-starwars}
starwars <- starwars %>%
  filter(is.na(gender) == FALSE) %>%
  filter(is.na(height) == FALSE)
```

Create a histogram of the variable `height()` using `geom_histogram()`. There should be 10 bins in your histogram.

```{r ggplot1, exercise = TRUE, exercise.setup = "prepare-starwars"}
ggplot(data = starwars, aes(x = height)) +

```

```{r ggplot1-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
ggplot(data = starwars, aes(x = height)) +
  geom_histogram(bins = 10)
```

```{r ggplot1-check, message = FALSE, warning = FALSE}
grade_code()
``` 

```{r ggplot2, echo=FALSE}
question("Describe the distribution of `height` (select all that apply). ",
  answer("Right-Skewed"),
  answer("Left-Skewed", correct = TRUE),
  answer("Symmetric"),
  answer("Uniform"),
  answer("Unimodal"),
  answer("Bimodal", correct = TRUE),
  answer("Multimodal"),
  allow_retry = T
)
```

There are times, such as when using a 2-sample $t$-test, that we want to look at a histogram for one variable over two different groups. That way, we can check the assumptions (normality) **for each group separately**--you may have noticed we only have one histogram above! 

Using base R, you *could* go through a longer process of creating subsets of the `starwars` data for each group, and then creating a histogram for each subset. There's nothing wrong with that approach! However, there is a much quicker way in the Tidyverse, using the **facets**. 

Facets break the dataset into groups and display a graph for each group in its own window. There are a couple of different kinds of facets (see more on the R cheat sheet in the R Resources folder on Moodle), but I like `facet_grid()`. 

You can add facets to your graph just like you add geoms--with the `+`. However, make sure that you add a plus sign EVERY TIME you add a new layer--we have two layers (one facet and one geom), so we need two plus signs (just like you need two pipe operators to calculate the summary statistics!).

```{r ggplot3, exercise = TRUE, message = FALSE, exercise.setup = "prepare-starwars"}
ggplot(data = starwars, aes(x = height)) + 
   facet_grid() + 
   geom_histogram(bins = 10)
```

Did anything happen when you ran that chunk of code? Probably not. That is because in addition to telling `ggplot2` we want facets, we need to tell it how to facet! This is where *formulas* come in. 

You may be used to seeing formulas written mathematically--typically, we see something like $y=ax^2 + bx + c$, where the explanatory variable, $x$, is on the right hand side of the equals sign and the response variable, $y$, is on the left hand side. In R, we use the tilde, `~`, to stand in for the equals sign. The same formula would look like `y~ax^2 + bx + c` in R. We saw an example with a response variable (a.k.a., the variable we are testing) and an explanatory variable (a.k.a., the grouping variable) in class on Tuesday: `log(TSPNDFOOD) ~ DIF`. 

To use formulas in `facet_grid()`, we don't need an explanatory and response variable. However, we need to specify what variables are described in the columns and rows. The variable described in rows is placed on the left hand side, and the variable described in columns is placed on the right hand side. If you only want rows, you replace the column side with a period (or vice-versa). 

The following graph shows two histograms in two columns. Can you make it show the same histograms in rows? Note that they won't look exactly the same due to "stretching" to fill the plot area. 

```{r ggplot4, exercise = TRUE, message = FALSE, exercise.setup = "prepare-starwars"}
ggplot(data = starwars, aes(x = height)) + 
   facet_grid(. ~ gender) + 
   geom_histogram(bins = 10)
```

```{r ggplot4-solution, message = FALSE, warning = FALSE, echo = FALSE}
ggplot(data = starwars, aes(x = height)) + 
   facet_grid(gender ~ .) + 
   geom_histogram(bins = 10)
```

```{r ggplot4-check, message = FALSE, warning = FALSE}
grade_code()
```

<div id="ggplot4-hint">
**Hint:** Change the facet formula!
</div>

In addition to creating different facets for different groups, you may also be interested in making each histogram its own color.

First, let's change the plot to be a color other than gray. The list of "official" colors in R is quite extensive--check it out [here](http://www.stat.columbia.edu/~tzheng/files/Rcolor.pdf). To change the color, you can add a `fill` argument in the `geom_histogram()` command. 

Based on the following chunk, make the histograms "darkviolet".

```{r ggplot5, exercise = TRUE, message = FALSE, exercise.setup = "prepare-starwars"}
ggplot(data = starwars, aes(x = height)) + 
   facet_grid(gender ~ .) + 
   geom_histogram(bins = 10)
```

```{r ggplot5-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
ggplot(data = starwars, aes(x = height)) + 
   facet_grid(gender ~ .) + 
   geom_histogram(fill = "darkviolet", bins = 10)
```

```{r ggplot5-check, message = FALSE, warning = FALSE}
grade_code()
```

On your assignments, you can pick whatever color you want! But in addition, you can change the color according to some variable. To do this, you can change the `fill` argument to be the name of a variable inside the `aes()` statement (rather than `geom_histogram()`).

Based on the following chunk, make each level of `gender` its own color.

```{r ggplot6, exercise = TRUE, message = FALSE, exercise.setup = "prepare-starwars"}
ggplot(data = starwars, aes(x = height)) + 
   facet_grid(gender ~ .) + 
   geom_histogram(bins = 10)
```

```{r ggplot6-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
ggplot(data = starwars, aes(x = height, fill = gender)) + 
   facet_grid(gender ~ .) + 
   geom_histogram(bins = 10)
```

```{r ggplot6-check, message = FALSE, warning = FALSE}
grade_code()
```

It is fine with me if you use the default color scheme in `ggplot2`, but if you want more color options, you can use the `RColorBrewer` package (or, the `wesanderson` package, which creates color palettes based on Wes Anderson movies--I like "GrandBudapest2").

To change the palette, load the `RColorBrewer` library and add a line of code to your graph. Notice that I am using `scale_fill_brewer()` because I am changing the `fill` inside `aes()`. What happens if you specify `palette="PiYG"` inside the new function?

```{r ggplot7, exercise = TRUE, message = FALSE, exercise.setup = "prepare-starwars"}
library(RColorBrewer)
ggplot(data = starwars, aes(x = height, fill = gender)) + 
   facet_grid(gender ~ .) + 
   geom_histogram(bins = 10) +
   scale_fill_brewer()
```

```{r ggplot7-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
library(RColorBrewer)
ggplot(data = starwars, aes(x = height, fill = gender)) + 
   facet_grid(gender ~ .) + 
   geom_histogram(bins = 10) +
   scale_fill_brewer(palette="PiYG")
```

```{r ggplot7-check, message = FALSE, warning = FALSE}
grade_code()
```

This is not a great option because the bottom graph is white--you can explore more color palette options [here](r-statistics.co/Complete-Ggplot2-Tutorial-Part1-With-R-Code.html) (search the page for "palette") or possibly, [here](https://web.archive.org/web/20210407205358/http://www.sthda.com/english/wiki/colors-in-r) (this is the better of the two tutorials but you have to access the archived version).

Now that we have histograms, we can investigate the assumptions for the 2-sample $t$-test. What are those assumptions? Does the data satisfy the assumptions?

## Part 5: Hypothesis Tests

### Star Wars

Let's say we want to compare the heights of Star Wars characters over the male and female genders--specifically, we are interested in seeing if there is any difference.  

```{r starwars1, echo = F}
question("What are the correct hypotheses for testing to see if there is any difference between the mean heights of male and female Star Wars characters?",
  answer("$H_0: \\mu_{Male} = \\mu_{Female}$ vs. $H_A: \\mu_{Male} \\neq \\mu_{Female}$", correct = TRUE),
  answer("$H_0: \\mu_{Male} = \\mu_{Female}$ vs. $H_A: \\mu_{Male} \\leq \\mu_{Female}$"),
  answer("$H_0: \\mu_{Male} = \\mu_{Female}$ vs. $H_A: \\mu_{Male} \\geq \\mu_{Female}$"),
  answer("$H_0: \\mu_{Male} \\neq \\mu_{Female}$ vs. $H_A: \\mu_{Male} = \\mu_{Female}$."),
  allow_retry = TRUE, 
  random_answer_order = TRUE
)
```

Next, we need a formula. Remember, the grouping variable goes on the righthand side, and the variable of interest goes on the left hand side. 

```{r starwars2, echo=FALSE}
question("What is the correct formula to use inside `t.test()`?",
  answer("`height ~ gender`", correct = TRUE),
  answer("`gender ~ height`"),
  answer("`height ~ .`"),
  answer("`. ~ gender`"),
  allow_retry = T,
  random_answer_order = TRUE
)
```

Now, we can calculate. Write a line of code to run a 2-sample $t$-test comparing height of Star Wars characters over the male and female genders. 

```{r starwars3, exercise = TRUE, message = FALSE, exercise.setup = "prepare-starwars"}
t.test()
```

```{r starwars3-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
t.test(height ~ gender, data = starwars)
```

```{r starwars3-check, message = FALSE, warning = FALSE}
grade_code()
```

```{r starwars4, echo=FALSE}
question("Would you reject or fail to reject this test at the 10% level?",
  answer("Fail to reject, because the p-value is greater than 0.1", correct = TRUE),
  answer("Reject, because the p-value is greater than 0.1"),
  answer("Fail to reject, because the p-value is less than 0.1"),
  answer("Reject, because the p-value is less than 0.1"),
  allow_retry = T,
  random_answer_order = TRUE
)
```

```{r starwars5, echo=FALSE}
question("What would a Type II error be in this scenario?",
  answer("Declaring that there is a difference in mean heights by gender when there is not a difference in heights by gender."),
  answer("Declaring that there is not a difference in mean heights by gender when there is not a difference in heights by gender."),
  answer("Declaring that there is a difference in mean heights by gender when there is a difference in heights by gender."),
  answer("Declaring that there is not a difference in mean heights by gender when there is a difference in heights by gender.", correct = TRUE),
  allow_retry = T,
  random_answer_order = TRUE
)
```

Make sure you and your group are able to formally write the results up for this analysis, including the Prepare, Check, Calculate, and Conclude steps. 

### Gestation Time

```{r prepare-gestation}
gestation <- read.csv("https://dasl.datadescription.com/download/data/3359")
```

A hospital is considering making changes to the prenatal care they offer, and would like to know if it changes the average length of pregnancy. They collect [data](https://dasl.datadescription.com/datafile/nashville/) on 70 pregnancies that resulted in births and want to compare it to the established human gestation time, 266 days. Use the `gestation` data frame and the variable `Gestation.Time` to carry out a full hypothesis test investigating the data.

```{r gestation1, echo = F}
question("What are the correct hypotheses for testing to see if the mean gestation time at the hospital is different to the established human gestation time?",
  answer("$H_0: \\mu = 266$ vs. $H_A: \\mu \\neq 266$", correct = TRUE),
  answer("$H_0: \\mu \\leq 266$ vs. $H_A: \\mu > 266$"),
  answer("$H_0: \\bar{x} = 266$ vs. $H_A: \\bar{x} \\neq 266$"),
  answer("$H_0: \\bar{x} \\leq 266$ vs. $H_A: \\bar{x} > 266$"),
  allow_retry = TRUE, 
  random_answer_order = TRUE
)
```

Calculate summary statistics $\bar{x}$, $s$, and $n$ for this dataset. 

```{r gestation2, exercise = TRUE, message = FALSE, exercise.setup = "prepare-gestation"}
gestation %>%
  summarize()
```

```{r gestation2-solution, message = FALSE, warning = FALSE, echo = FALSE}
gestation %>%
  summarize(Mean = mean(Gestation.Time), SD = sd(Gestation.Time), n = n())
```

```{r gestation2-check, message = FALSE, warning = FALSE}
grade_code()
```

Now, create a histogram with 8 bins to check the assumptions for the $t$-test. Does the histogram support the assumptions for the test?

```{r gestation3, exercise = TRUE, message = FALSE, exercise.setup = "prepare-gestation"}

```

```{r gestation3-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
ggplot(data = gestation, aes(x = Gestation.Time)) +
  geom_histogram(bins = 8)
```

```{r gestation3-check, message = FALSE, warning = FALSE}
grade_code()
```

Next, we can calculate. Write a line of code to run a 1-sample $t$-test comparing the mean gestation to 266 days. 

```{r gestation4, exercise = TRUE, message = FALSE, exercise.setup = "prepare-gestation"}
t.test()
```

```{r gestation4-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
t.test(gestation$Gestation.Time, mu = 266)
```

```{r gestation4-check, message = FALSE, warning = FALSE}
grade_code()
```

```{r gestation5, echo=FALSE}
question("Would you reject or fail to reject this test at the 1% level?",
  answer("Fail to reject, because the p-value is greater than 0.01"),
  answer("Reject, because the p-value is greater than 0.01"),
  answer("Fail to reject, because the p-value is less than 0.01"),
  answer("Reject, because the p-value is less than 0.01", correct = TRUE),
  allow_retry = T,
  random_answer_order = TRUE
)
```

```{r gestation6, echo=FALSE}
question("What would a Type I error be in this scenario?",
  answer("Declaring that the mean gestation time is different from 266 days when it really is 266 days.", correct = TRUE),
  answer("Declaring that the mean gestation time is not different from 266 days when it really is 266 days."),
  answer("Declaring that the mean gestation time is different from 266 days when it really is not 266 days."),
  answer("Declaring that the mean gestation time is not different from 266 days when it really is not 266 days."),
  allow_retry = T,
  random_answer_order = TRUE
)
```

Make sure you and your group are able to formally write the results up for this analysis, including the Prepare, Check, Calculate, and Conclude steps. 

### COVID-19 Vaccines

Does a person's education play a significant roll in their willingness to get a COVID-19 vaccine? A [Gallup survey from 2020](https://news.gallup.com/poll/325208/americans-willing-covid-vaccine.aspx) shows this might be the case. Assume that out of a sample of 200 people with college degrees, 126 are willing to take an FDA-approved vaccine to prevent COVID-19 if it were available at no cost, and that out of a sample of 100 people with no college degree, 55 are willing to take an FDA-approved vaccine to prevent COVID-19 if it were available at no cost. Is the proportion of people with college degrees willing to take a COVID-19 vaccine higher than the proportion of people without college degrees?

```{r vaccine, echo = F}
question("What are the correct hypotheses for testing to see if there is any difference between the proportion of Americans with a college degree who are willing to take an approved vaccine and the proportion of Americans without a college degree who are willing to take an approved vaccine",
  answer("$H_0: \\mu_{College} = \\mu_{No \\; College}$ vs. $H_A: \\mu_{College} \\neq \\mu_{No \\; College}$"),
  answer("$H_0: p_{College} = p_{No \\; College}$ vs. $H_A: p_{College} \\neq p_{No \\; College}$", correct = TRUE),
  answer("$H_0: \\mu_{College} \\leq \\mu_{No \\; College}$ vs. $H_A: \\mu_{College} > \\mu_{No \\; College}$"),
  answer("$H_0: p_{College} \\leq p_{No \\; College}$ vs. $H_A: p_{College} > p_{No \\; College}$"),
  allow_retry = TRUE, 
  random_answer_order = TRUE
)
```

Calculate $\hat{p}$ for both groups (save them as `p_college` and `p_nocollege`).

```{r vaccine2, exercise = TRUE, message = FALSE}
p_college <- 
p_nocollege <- 
```

```{r vaccine2-solution, message = FALSE, warning = FALSE, echo = FALSE}
p_college <- 126/200
p_nocollege <- 55/100
```

```{r vaccine2-check, message = FALSE, warning = FALSE}
grade_code()
```

Calculate $\hat{p}_{pooled}$ (save it as `p_pooled`).

```{r vaccine3, exercise = TRUE, message = FALSE}
p_pooled <- 
```

```{r vaccine3-solution, message = FALSE, warning = FALSE, echo = FALSE, echo = FALSE}
p_pooled <- (126+55)/(200+100)
```

```{r vaccine3-check, message = FALSE, warning = FALSE}
grade_code()
```

Are the assumptions met for a 2-proportion $z$-test?

```{r prepare-vaccine}
p_pooled <- (126+55)/(200+100)
```

```{r vaccine4, exercise = TRUE, message = FALSE, exercise.setup = "prepare-vaccine"}

```

```{r vaccine4-solution, message = FALSE, warning = FALSE, echo = FALSE}
200*(p_pooled)
200*(1-p_pooled)

100*(p_pooled)
100*(1-p_pooled)
```

```{r vaccine4-check, message = FALSE, warning = FALSE}
grade_code()
```

Now, run the test. 

```{r vaccine5, exercise = TRUE, message = FALSE}

```

```{r vaccine5-solution, message = FALSE, warning = FALSE, echo = FALSE}
prop.test(x = c(126, 55), n = c(200, 100), alternative = "g", correct = FALSE)
```

```{r vaccine5-check, message = FALSE, warning = FALSE}
grade_code()
```

```{r vaccine6, echo=FALSE}
question("Would you reject or fail to reject this test at the 5% level?",
  answer("Fail to reject, because the p-value is greater than 0.05", correct = TRUE),
  answer("Reject, because the p-value is greater than 0.05"),
  answer("Fail to reject, because the p-value is less than 0.05"),
  answer("Reject, because the p-value is less than 0.05"),
  allow_retry = T,
  random_answer_order = TRUE
)
```

```{r vaccine7, echo=FALSE}
question("What would a Type I error be in this scenario?",
  answer("Declaring that there is a difference when the proportions of Americans with and without a college degree who are willing to get an approved vaccine are the same.", correct = TRUE),
  answer("Declaring that there is not a difference when the proportions of Americans with and without a college degree who are willing to get an approved vaccine are the same."),
  answer("Declaring that there is a difference when the proportions of Americans with and without a college degree who are willing to get an approved vaccine are not the same."),
  answer("Declaring that there is not a difference when the proportions of Americans with and without a college degree who are willing to get an approved vaccine are not the same."),
  allow_retry = T,
  random_answer_order = TRUE
)
```

Make sure you and your group are able to formally write the results up for this analysis, including the Prepare, Check, Calculate, and Conclude steps. 
