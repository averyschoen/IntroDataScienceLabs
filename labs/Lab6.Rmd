---
title: "Lab 6"
output: learnr::tutorial
runtime: shiny_prerendered
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE)

library(gradethis)
library(learnr)
library(readr)

tutorial_options(exercise.checker = gradethis::grade_learnr)

toys <- c(0, 1, 2, 3, 4, 5)
probs <- c(0.03, 0.16, 0.30, 0.23, 0.17, 0.11)

```

## Goals

Your goal is practice calculating the expected value and variance for a random variable, evaluating more probabilities, and using the Central Limit Theorem. 

## Part 1: Loading Packages

No new libraries today!

## Part 2: Reading in Data

No data to read in today!

## Part 3: Expected Value and Variance

### Toys

In an experiment on the behavior of young children, each subject is placed in an area with five toys. The response of interest is the number of toys that the child plays with. Past experiments with many subjects have shown that the probability distribution of the number $T$ of toys played with is as follows:

$T$ | 0 | 1 | 2 | 3 | 4 | 5 
--|---|---|---|---|---|---
$P(T)$ | 0.03 | 0.16 | 0.30 | 0.23 | 0.17 | 0.11

Save the possible outcomes of $T$ as a vector named `toys`. 

```{r toys1, exercise = TRUE}
toys <- c()
```

```{r toys1-solution, message = FALSE, warning = FALSE}
toys <- c(0, 1, 2, 3, 4, 5)
```

```{r toys1-check, message = FALSE, warning = FALSE}
grade_code()
```

Now, save the probabilities as a vector named `probs`. 

```{r toys2, exercise = TRUE}

```

```{r toys2-solution, message = FALSE, warning = FALSE}
probs <- c(0.03, 0.16, 0.30, 0.23, 0.17, 0.11)
```

```{r toys2-check, message = FALSE, warning = FALSE}
grade_code()
```

Using `toys` and `probs`, calculate the expected value of the number of toys played with. Save it as `exp_toys`, and print the value out so you can see it.

```{r toys3, exercise = TRUE}

```

```{r toys3-solution, message = FALSE, warning = FALSE}
exp_toys <- sum(toys*probs)
exp_toys
```

```{r toys3-check, message = FALSE, warning = FALSE}
grade_code()
```

Using `toys` and `probs`, as well as the expected value, calculate the variance of the number of toys plated with. Save it as `var_toys`, and print the value out so you can see it.

```{r prepare-toys1, message = FALSE}
toys <- c(0, 1, 2, 3, 4, 5)
probs <- c(0.03, 0.16, 0.30, 0.23, 0.17, 0.11)
exp_toys <- sum(toys*probs)
```

```{r toys4, exercise = TRUE, exercise.setup = "prepare-toys1"}

```

```{r toys4-solution, message = FALSE, warning = FALSE}
var_toys <- sum((toys - exp_toys)^2*probs)
var_toys
```

```{r toys4-check, message = FALSE, warning = FALSE}
grade_code()
```

Now, calculate the standard deviation. Save it as `sd_toys`, and print the value out so you can see it.

```{r prepare-toys2, message = FALSE}
toys <- c(0, 1, 2, 3, 4, 5)
probs <- c(0.03, 0.16, 0.30, 0.23, 0.17, 0.11)
exp_toys <- sum(toys*probs)
var_toys <- sum((toys - exp_toys)^2*probs)
```

```{r toys5, exercise = TRUE, exercise.setup = "prepare-toys2"}

```

```{r toys5-solution, message = FALSE, warning = FALSE}
sd_toys <- sqrt(var_toys)
sd_toys
```

```{r toys5-check, message = FALSE, warning = FALSE}
grade_code()
```

What is the probability that a child plays with more than the expected value of toys?

```{r toys6, exercise = TRUE}

```

```{r toys6-solution, message = FALSE, warning = FALSE}
0.23 + 0.17 + 0.11
```

```{r toys6-check, message = FALSE, warning = FALSE}
grade_result({
  pass_if(~ all.equal(.result, 0.23 + 0.17 + 0.11))
})
```

A researcher invites 10 children to the area to be observed. What is the probability that none of the 10 play with 5 toys?

```{r toys7, exercise = TRUE}

```

```{r toys7-solution, message = FALSE, warning = FALSE}
(1-0.11)^10
```

```{r toys7-check, message = FALSE, warning = FALSE}
grade_result({
  pass_if(~ all.equal(.result, (1-0.11)^10))
})
```

This problem was taken from *The Practice of Statistics*, by Yates, Moore, and McCabe.

## Part 4: More Probability Practice

### Candy Corn

Quality Control at a candy corn factory has determined that the rate of defective candy corn pieces per bag is 6.

What is the probability that there are 0 defective pieces in a bag?

```{r candycorn1, exercise = TRUE}

```

```{r candycorn1-solution, message = FALSE, warning = FALSE}
dpois(0, lambda = 6)
```

```{r candycorn1-check, message = FALSE, warning = FALSE}
grade_result({
  pass_if(~ all.equal(.result, dpois(0, lambda = 6)))
})
```

What is the probability that there are at least five defective pieces in a bag?

```{r candycorn2, exercise = TRUE}

```

```{r candycorn2-solution, message = FALSE, warning = FALSE}
1 - ppois(4, lambda = 6)
```

```{r candycorn2-check, message = FALSE, warning = FALSE}
grade_result({
  pass_if(~ all.equal(.result, 1 - ppois(4, lambda = 6)))
})
```

What is the probability that there are no more than 9 defective pieces in a bag?

```{r candycorn3, exercise = TRUE}

```

```{r candycorn3-solution, message = FALSE, warning = FALSE}
ppois(9, lambda = 6)
```

```{r candycorn3-check, message = FALSE, warning = FALSE}
grade_result({
  pass_if(~ all.equal(.result, ppois(9, lambda = 6)))
})
```

### Traveling

I am packing a bag to go on a trip--I am planning on taking 10 shirts and 3 pairs of pants. For some reason, I know that the weight of my shirts, $S$, is normally distributed with a mean of 142 g ($\sigma = 19g$) and the weight of my pants, $P$, is normally distributed with a mean of 725 g ($\sigma = 25g$). The weight of my suitcase and toiletries is 8,000 grams.

```{r travel1, echo = F}
question("Write a linear combination to express the total weight, $W$, of my suitcase with all of my clothes and toiletries in grams.",
  answer("$10S + 3P + 8000$", correct = TRUE),
  answer("$3S + 10P + 8000$"),
  answer("$10^2S + 3^2P + 8000^2$"),
  answer("$142S + 725P + 8000$"),
  allow_retry = T, 
  random_answer_order = TRUE
)
```

How much can I expect my suitcase to weigh? Save the value as `exp_grams`, and print it out so you can see it.

```{r travel2, exercise = TRUE}

```

```{r travel2-solution, message = FALSE, warning = FALSE}
exp_grams <- 10*142 + 3*725 + 8000
exp_grams
```

```{r travel2-check, message = FALSE, warning = FALSE}
grade_code()
```

What is the variance of my suitcase's weight? Save the value as `var_grams`, and print it out so you can see it.

```{r prepare-travel1, message = FALSE}
exp_grams <- 10*142 + 3*725 + 8000
```

```{r travel3, exercise = TRUE, exercise.setup = "prepare-travel1"}

```

```{r travel3-solution, message = FALSE, warning = FALSE}
var_grams <- 10^2*19^2 + 3^2*25^2 
var_grams
```

```{r travel3-check, message = FALSE, warning = FALSE}
grade_code()
```

What is the standard deviation of my suitcase's weight? Save the value as `sd_grams`, and print it out so you can see it.

```{r prepare-travel2, message = FALSE}
exp_grams <- 10*142 + 3*725 + 8000
var_grams <- 10^2*19^2 + 3^2*25^2 
```

```{r travel4, exercise = TRUE, exercise.setup = "prepare-travel2"}

```

```{r travel4-solution, message = FALSE, warning = FALSE}
sd_grams <- sqrt(var_grams)
sd_grams
```

```{r travel4-check, message = FALSE, warning = FALSE}
grade_code()
```

```{r travel5, echo = F}
question("Write a linear combination to express the total weight of my suitcase with all of my clothes and toiletries in pounds (knowing that there are 453.592g in a pound and 16 oz. in a pound).",
  answer("$453.592W$"),
  answer("$\\frac{1}{453.592}W$", correct = TRUE),
  answer("$16W$"),
  answer("$\\frac{1}{16}W$"),
  allow_retry = T, 
  random_answer_order = TRUE
)
```

How much can I expect my suitcase to weigh, in pounds? Save the value as `exp_pounds`, and print it out so you can see it.

```{r travel6, exercise = TRUE}

```

```{r travel6-solution, message = FALSE, warning = FALSE}
exp_pounds <- 11595/453.592
exp_pounds
```

```{r travel6-check, message = FALSE, warning = FALSE}
grade_code()
```

What is the variance of my suitcase's weight, in pounds? Save the value as `var_pounds`, and print it out so you can see it.

```{r travel7, exercise = TRUE}

```

```{r travel7-solution, message = FALSE, warning = FALSE}
var_pounds <- (10^2*19^2 + 3^2*25^2)/453.592^2
var_pounds
```

```{r travel7-check, message = FALSE, warning = FALSE}
grade_code()
```

What is the standard deviation of my suitcase's weight? Save the value as `sd_pounds`, and print it out so you can see it.

```{r prepare-travel3, message = FALSE}
exp_grams <- 10*142 + 3*725 + 8000
var_grams <- 10^2*19^2 + 3^2*25^2 
sd_grams <- sd_grams <- sqrt(var_grams)

exp_pounds <- 11595/453.592
var_pounds <- (10^2*19^2 + 3^2*25^2)/453.592^2
```

```{r travel8, exercise = TRUE, exercise.setup = "prepare-travel3"}

```

```{r travel8-solution, message = FALSE, warning = FALSE}
sd_pounds <- sqrt(var_pounds)
sd_pounds
```

```{r travel8-check, message = FALSE, warning = FALSE}
grade_code()
```

What is the probability that my suitcase weighs less than 24.2 pounds?

```{r prepare-travel4, message = FALSE}
exp_grams <- 10*142 + 3*725 + 8000
var_grams <- 10^2*19^2 + 3^2*25^2 
sd_grams <- sd_grams <- sqrt(var_grams)

exp_pounds <- 11595/453.592
var_pounds <- (10^2*19^2 + 3^2*25^2)/453.592^2
sd_pounds <- sqrt(var_pounds)
```

```{r travel9, exercise = TRUE, exercise.setup = "prepare-travel4"}

```

```{r travel9-solution, message = FALSE, warning = FALSE}
pnorm(24.2, mean = exp_pounds, sd = sd_pounds)
```

```{r travel9-check, message = FALSE, warning = FALSE}
grade_result({
  pass_if(~ all.equal(.result, pnorm(24.2, mean = exp_pounds, sd = sd_pounds)))
})
```

What is the probability that my suitcase weighs between 11,400 and 11,600 grams?

```{r travel10, exercise = TRUE, exercise.setup = "prepare-travel4"}

```

```{r travel10-solution, message = FALSE, warning = FALSE}
pnorm(11600, mean = exp_grams, sd = sd_grams) - pnorm(11400, mean = exp_grams, sd = sd_grams)
```

```{r travel10-check, message = FALSE, warning = FALSE}
grade_result({
  pass_if(~ all.equal(.result, pnorm(11600, mean = exp_grams, sd = sd_grams) - pnorm(11400, mean = exp_grams, sd = sd_grams)))
})
```

As a personal rule, I will check my bag if it weighs more than 25 pounds. What is the probability I will have to check my bag?

```{r travel11, exercise = TRUE, exercise.setup = "prepare-travel4"}

```

```{r travel11-solution, message = FALSE, warning = FALSE}
1 - pnorm(25, mean = exp_pounds, sd = sd_pounds)
```

```{r travel11-check, message = FALSE, warning = FALSE}
grade_result({
  pass_if(~ all.equal(.result, 1 - pnorm(25, mean = exp_pounds, sd = sd_pounds)))
})
```

What bag weight represents the $70^{th}$ percentile, in grams?

```{r travel12, exercise = TRUE, exercise.setup = "prepare-travel4"}

```

```{r travel12-solution, message = FALSE, warning = FALSE}
qnorm(0.7, mean = exp_grams, sd = sd_grams)
```

```{r travel12-check, message = FALSE, warning = FALSE}
grade_result({
  pass_if(~ all.equal(.result, qnorm(0.7, mean = exp_grams, sd = sd_grams)))
})
```

## Part 5: Central Limit Theorem

When practicing these questions, make sure you are asking yourself what distribution you should be using!

### Toys, Continued

Now researchers are running a new experiment where they invite 81 children to the area to play with toys. 

```{r moretoys0, echo = F}
question("What distribution should be used to calculate the probabilities associated with the average number of toys that the 81 children play with? Assume the 81 children are independent from each other.",
  answer("Normal", correct = TRUE),
  answer("Poisson"),
  answer("Binomial"),
  answer("Geometric"),
  allow_retry = T, 
  random_answer_order = TRUE
)
```

According to the Central Limit Theorem, we know the mean of the distribution used to calculate this probability is 2.68. What is the standard deviation of this distribution? Save it as `se_toys` (for standard **E**rror), and print it out so you can see it.

```{r prepare-toys3, message = FALSE}
toys <- c(0, 1, 2, 3, 4, 5)
probs <- c(0.03, 0.16, 0.30, 0.23, 0.17, 0.11)
exp_toys <- sum(toys*probs)
var_toys <- sum((toys - exp_toys)^2*probs)
sd_toys <- sqrt(var_toys)
```

```{r moretoys1, exercise = TRUE, exercise.setup = "prepare-toys3"}

```

```{r moretoys1-solution, message = FALSE, warning = FALSE}
se_toys <- sd_toys/sqrt(81)
se_toys
```

```{r moretoys1-check, message = FALSE, warning = FALSE}
grade_code()
```

What is the probability that the average number of toys played with is less than 3?

```{r prepare-toys4, message = FALSE}
toys <- c(0, 1, 2, 3, 4, 5)
probs <- c(0.03, 0.16, 0.30, 0.23, 0.17, 0.11)
exp_toys <- sum(toys*probs)
var_toys <- sum((toys - exp_toys)^2*probs)
sd_toys <- sqrt(var_toys)
se_toys <- sd_toys/sqrt(81)
```

```{r moretoys2, exercise = TRUE, exercise.setup = "prepare-toys4"}

```

```{r moretoys2-solution, message = FALSE, warning = FALSE}
pnorm(3, mean = exp_toys, sd = se_toys)
```

```{r moretoys2-check, message = FALSE, warning = FALSE}
grade_result({
  pass_if(~ all.equal(.result, pnorm(3, mean = 2.68, sd = sqrt(sum((toys - 2.68)^2*probs))/sqrt(81))))
})
```

What is the probability that the average number of toys played with is between 1 and 2?

```{r moretoys3, exercise = TRUE, exercise.setup = "prepare-toys4"}

```

```{r moretoys3-solution, message = FALSE, warning = FALSE}
pnorm(2, mean = exp_toys, sd = se_toys) - pnorm(1, mean = exp_toys, sd = se_toys)
```

```{r moretoys3-check, message = FALSE, warning = FALSE}
grade_result({
  pass_if(~ all.equal(.result, pnorm(2, mean = 2.68, sd = sqrt(sum((toys - 2.68)^2*probs))/sqrt(81)) - pnorm(1, mean = 2.68, sd = sqrt(sum((toys - 2.68)^2*probs))/sqrt(81))))
})
```

### San Antonio Spurs

Some of these questions are the same as last week, but is helpful to review them. In the 2019-2020 NBA season prior to the break caused by COVID-19, the San Antonio Spurs scored an average of 28.25 points per quarter (4 quarters of 12 minutes each per one game). Let $S$ be a random variable describing the number of points scored in a quarter.

```{r spurs1, echo=FALSE, eval = F}
question("What distribution is most appropriate to use to calculate the probability of scoring more than 32 points in a quarter?",
  answer("Poisson", correct = TRUE),
  answer("Binomial"),
  answer("Geometric"),
  answer("Bernoulli"), 
  allow_retry = T,
  random_answer_order = TRUE
)
```

What are the expected value and the standard deviation of this distribution? Save them as `exp_spurs` and `sd_spurs`, and print them out so you can see them.

```{r spurs2, exercise = TRUE}
exp_spurs <- 
sd_spurs <-
```

```{r spurs2-solution, message = FALSE, warning = FALSE}
exp_spurs <- 28.25
sd_spurs <- sqrt(28.25)
```

```{r spurs2-check, message = FALSE, warning = FALSE}
grade_code()
```

What is the probability that the San Antonio Spurs scored more than 32 points in a quarter?

```{r spurs3, exercise = TRUE}

```

```{r spurs3-solution, message = FALSE, warning = FALSE}
1 - ppois(32, lambda = 28.25)
```

```{r spurs3-check, message = FALSE, warning = FALSE}
grade_result({
  pass_if(~ all.equal(.result, 1 - ppois(32, lambda = 28.25)))
})
```

What is the probability that the San Antonio Spurs score between 24 and 28 points in a quarter (including both 24 and 28)?

```{r spurs4, exercise = TRUE}

```

```{r spurs4-solution, message = FALSE, warning = FALSE}
sum(dpois(24:28, lambda = 28.25))
```

```{r spurs4-check, message = FALSE, warning = FALSE}
grade_result({
  pass_if(~ all.equal(.result, sum(dpois(24:28, lambda = 28.25))))
})
```

The Spurs were scheduled to play eight games in the "bubble" in Orlando. They wanted to improve their chances of making the playoffs by scoring more than 30 points per quarter for all 8 games in a row (32 quarters total). 

```{r spurs45, echo = F}
question("What distribution should be used to calculate the probability that their average rate over the next 32 quarters is more than 30 points per quarter? Assume the 32 quarters are independent from each other.",
  answer("Normal", correct = TRUE),
  answer("Poisson"),
  answer("Binomial"),
  answer("Geometric"),
  allow_retry = T, 
  random_answer_order = TRUE
)
```

According to the Central Limit Theorem, we know the mean of the distribution used to calculate this probability is 28.25. What is the standard deviation of this distribution? Save it as `se_spurs`, and print it out so you can see it.

```{r prepare-spurs, message = FALSE}
exp_spurs <- 28.25
sd_spurs <- sqrt(28.25)
```

```{r spurs5, exercise = TRUE, exercise.setup = "prepare-spurs"}

```

```{r spurs5-solution, message = FALSE, warning = FALSE}
se_spurs <- sqrt(28.25)/sqrt(32)
se_spurs
```

```{r spurs5-check, message = FALSE, warning = FALSE}
grade_code()
```

What is the probability that the average point-scoring rate for the San Antonio Spurs over the next 32 quarters is more than 30 points per quarter?

```{r prepare-spurs2, message = FALSE}
exp_spurs <- 28.25
sd_spurs <- sqrt(28.25)
se_spurs <- sqrt(28.25)/sqrt(32)
```

```{r spurs6, exercise = TRUE, exercise.setup = "prepare-spurs2"}

```

```{r spurs6-solution, message = FALSE, warning = FALSE}
1-pnorm(30, mean = 28.25, sd = sqrt(28.25)/sqrt(32))
```

```{r spurs6-check, message = FALSE, warning = FALSE}
grade_result({
  pass_if(~ all.equal(.result, 1-pnorm(30, mean = 28.25, sd = sqrt(28.25)/sqrt(32))))
})
```

Assume you are given the choice to make a bet on the San Antonio Spurs. Is it safer to bet that the average point-scoring rate for the San Antonio Spurs is more than 30 points per quarter over the next 32 quarters, or that the San Antonio Spurs will score more than 30 points in every quarter for the next 32 quarters? How do you know?

### Rush Hour Traffic

A study of rush-hour traffic in San Francisco counts the number of people in each car entering a freeway at a suburban interchange. Suppose that this count has mean ($\mu$) 1.5 and standard deviation ($\sigma$) 0.75 in the population of all cars that enter at this exchange during rush hours. Save these values as `exp_cars` and `sd_cars`, and print them out so you can see them.

```{r rushhour0, exercise = TRUE}
exp_cars <- 
sd_cars <-
```

```{r rushhour0-solution, message = FALSE, warning = FALSE}
exp_cars <- 1.5
sd_cars <- 0.75
```

```{r rushhour0-check, message = FALSE, warning = FALSE}
grade_code()
```

Could the exact distribution of the count be normal? Why or why not?

Traffic engineers estimate that the capacity of the interchange is 700 cars per hour. 

```{r rushhour1, echo=FALSE, eval = F}
question("According to the Central Limit Theorem, what is the approximate distribution of the mean number of persons ($\\bar{x}$) in 700 randomly selected cars at this interchange?",
  answer("$N(1.5, 0.028)$", correct = TRUE),
  answer("$N(1.5, 0.75)$"),
  answer("$N(0, 1)$"),
  answer("$N(700, 0.75)$"), 
  allow_retry = T,
  random_answer_order = TRUE
)
```

What is the probability that the average in 700 randomly selected cars is greater than 1.55?

```{r prepare-cars1, message = FALSE}
exp_cars <- 1.5
sd_cars <- 0.75
```

```{r rushhour2, exercise = TRUE, exercise.setup = "prepare-cars1"}

```

```{r rushhour2-solution, message = FALSE, warning = FALSE}
se_cars <- sd_cars/sqrt(700)
1-pnorm(1.55, mean = exp_cars, sd = se_cars)
```

```{r rushhour2-check, message = FALSE, warning = FALSE}
grade_result({
  pass_if(~ all.equal(.result, 1-pnorm(1.55, mean = 1.5, sd = 0.75/sqrt(700))))
})
```

What is the probability that the average in 700 randomly selected cars is between 1.42 and 1.48?

```{r prepare-cars2, message = FALSE}
exp_cars <- 1.5
sd_cars <- 0.75
se_cars <- sd_cars/sqrt(700)
```

```{r rushhour3, exercise = TRUE, exercise.setup = "prepare-cars2"}

```

```{r rushhour3-solution, message = FALSE, warning = FALSE}
pnorm(1.48, mean = 1.5, sd = 0.75/sqrt(700)) - pnorm(1.42, mean = 1.5, sd = 0.75/sqrt(700))
```

```{r rushhour3-check, message = FALSE, warning = FALSE}
grade_result({
  pass_if(~ all.equal(.result, pnorm(1.48, mean = 1.5, sd = 0.75/sqrt(700)) - pnorm(1.42, mean = 1.5, sd = 0.75/sqrt(700))))
})
```

What is the probability that 700 cars will carry more than 1075 people? Restate this event in terms of the mean number of people $\bar{x}$ per car. 

```{r rushhour4, exercise = TRUE, exercise.setup = "prepare-cars2"}

```

```{r rushhour4-solution, message = FALSE, warning = FALSE}
1-pnorm(1075/700, mean = 1.5, sd =  0.75/sqrt(700))
```

```{r rushhour4-check, message = FALSE, warning = FALSE}
grade_result({
  pass_if(~ all.equal(.result, 1-pnorm(1075/700, mean = 1.5, sd =  0.75/sqrt(700))))
})
```

This problem was inspired by a practice set from *The Practice of Statistics*, by Yates, Moore, and McCabe.



